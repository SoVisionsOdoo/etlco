<?xml version="1.0" encoding="utf-8" ?>
<odoo>

    <template id="customer_einvoice_report_template_ar">
        <t t-call="so_invoice_report.external_layout_invoice">
            <t t-set="o" t-value="doc.with_context({'lang': 'en_US'})"/>
            <div class="page">
                <t t-foreach="docs" t-as="o">
                    <t t-if="o.move_type == 'out_invoice'">
                        <h3 dir="rtl" align="center">
                            <strong>فاتورة ضريبية</strong>
                            <span t-field="o.name"/>
                        </h3>
                    </t>
                    <t t-if="o.move_type == 'in_invoice'">
                        <h3 dir="rtl" align="center">
                            <strong>فاتورة ضريبية</strong>
                            <span t-field="o.name"/>
                        </h3>
                    </t>
                    <t t-if="o.move_type == 'out_refund'">
                        <h3 dir="rtl" align="center">
                            <strong>مرتجع فاتورة ضريبية</strong>
                            <span t-field="o.name"/>
                        </h3>
                    </t>
                    <t t-if="o.move_type == 'in_refund'">
                        <h3 dir="rtl" align="center">
                            <strong>مرتجع فاتورة ضريبية</strong>
                            <span t-field="o.name"/>
                        </h3>
                    </t>
                    <br/>
                    <div dir="rtl">
                        <table class="table table-sm">
                            <tbody>
                                <tr>
                                    <td style="width:60%; border:none;">
                                        <div dir="rtl" align="right">
                                            <strong>
                                                التاريخ :
                                            </strong>
                                            <span t-field="o.invoice_date"/>
                                        </div>
                                        <div dir="rtl" align="right">
                                            <strong>
                                                الرقم الضريبي :
                                            </strong>
                                            <span t-field="o.partner_id.vat"/>
                                        </div>
                                        <div dir="rtl" align="right">
                                            <t t-if="o.move_type == 'out_invoice'">
                                                <strong>
                                                    اسم العميل :
                                                </strong>
                                            </t>
                                            <t t-if="o.move_type == 'out_refund'">
                                                <strong>
                                                    اسم العميل :
                                                </strong>
                                            </t>
                                            <t t-if="o.move_type == 'in_refund'">
                                                <strong>
                                                    اسم المورد :
                                                </strong>
                                            </t>
                                            <t t-if="o.move_type == 'in_invoice'">
                                                <strong>
                                                    اسم المورد :
                                                </strong>
                                            </t>
                                            <span t-field="o.partner_id.name"/>
                                        </div>
                                    </td>
                                    <td style="width:5%; border:none;"></td>
                                    <td style="width:35%; border:none;">
                                        <div>
                                            <!--<t t-set="report_info" t-value="xmlid" invisible="1"/>-->
                                            <!--<img t-if="o._get_api_code(report_info)"-->
                                            <!--t-att-src="'/report/barcode/?type=%s&amp;value=%s&amp;width=%s&amp;height=%s&amp;humanreadable=1' % ('QR', o._get_api_code(report_info) , 100, 100)"-->
                                            <!--alt="Qrcode"/>-->
                                            <img t-if="o.l10n_sa_qr_code_str"
                                                 style="display:block;margin:10% auto 0 auto;"
                                                 t-att-src="'/report/barcode/?type=%s&amp;value=%s&amp;width=%s&amp;height=%s'%('QR', o.l10n_sa_qr_code_str, 150, 150)"/>

                                        </div>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <!-- <div class="row">
                        <div dir="rtl" class="col-3">
                            <strong>
                                التاريخ :
                            </strong>
                            <span t-field="o.invoice_date"/>
                        </div>

                        <div dir="rtl" class="col-4">
                            <strong>
                                الرقم الضريبي :
                            </strong>
                            <span t-field="o.partner_id.vat"/>
                        </div>
                        <div dir="rtl" class="col-5" align="right">
                            <t t-if="o.move_type == 'out_invoice'">
                                <strong>
                                    اسم العميل :
                                </strong>
                            </t>
                            <t t-if="o.move_type == 'out_refund'">
                                <strong>
                                    اسم العميل :
                                </strong>
                            </t>
                            <t t-if="o.move_type == 'in_refund'">
                                <strong>
                                    اسم المورد :
                                </strong>
                            </t>
                            <t t-if="o.move_type == 'in_invoice'">
                                <strong>
                                    اسم المورد :
                                </strong>
                            </t>
                            <span t-field="o.partner_id.name"/>
                        </div>

                    </div>
                    <div>
                        <t t-set="report_info" t-value="xmlid" invisible="1"/>
                        <img t-if="o._get_api_code(report_info)"
                             t-att-src="'/report/barcode/?type=%s&amp;value=%s&amp;width=%s&amp;height=%s&amp;humanreadable=1' % ('QR', o._get_api_code(report_info) , 100, 100)"
                             alt="Qrcode"/>
                        <br/>
                        <br/>
                    </div> -->
                    <!--<div class="row">-->
                    <!--<div align='right' class="col-12">-->
                    <!--<t t-if="o.move_type == 'out_invoice'">-->
                    <!--<strong>-->
                    <!--كود العميل :-->
                    <!--</strong>-->
                    <!--</t>-->
                    <!--<t t-if="o.move_type == 'out_refund'">-->
                    <!--<strong>-->
                    <!--كود العميل :-->
                    <!--</strong>-->
                    <!--</t>-->
                    <!--<t t-if="o.move_type == 'in_invoice'">-->
                    <!--<strong>-->
                    <!--كود المورد :-->
                    <!--</strong>-->
                    <!--</t>-->
                    <!--<t t-if="o.move_type == 'in_refund'">-->
                    <!--<strong>-->
                    <!--كود المورد :-->
                    <!--</strong>-->
                    <!--</t>-->
                    <!--<span t-field="o.partner_id.code"/>-->

                    <!--</div>-->
                    <!--</div>-->
                    <table class="table table-bordered" border="1" dir="rtl" width="100%" cellpadding="7"
                           cellspacing="0">
                        <colgroup>
                            <col width="10%"/>
                            <col width="25%"/>
                            <col width="10%"/>
                            <col width="10%"/>
                            <col width="10%"/>
                            <col width="10%"/>
                            <col width="10"/>
                            <col width="15%"/>
                        </colgroup>

                        <thead>
                            <tr>
                                <th width="10%" style="text-align:center">
                                    الكود
                                    <br/>
                                    Code
                                </th>
                                <th width="25%" style="text-align:center">
                                    الصنف
                                    <br/>
                                    Item
                                </th>
                                <th width="10%" style="text-align:center">
                                    الوحدة
                                    <br/>
                                    Unit
                                </th>
                                <th width="10%" style="text-align:center">
                                    الكمية
                                    <br/>
                                    Quantity
                                </th>
                                <th width="10%" style="text-align:center">
                                    السعر
                                    <br/>
                                    U.Price
                                </th>
                                <th width="10%" style="text-align:center">
                                    الخصم
                                    <br/>
                                    Discount
                                </th>
                                <th width="12%" style="text-align:center">
                                    الضريبة
                                    <br/>
                                    Vat
                                </th>
                                <th width="15%" height="4" style="text-align:center">
                                    الاجمالي
                                    <br/>
                                    Total
                                </th>
                            </tr>
                        </thead>
                        <tbody>
                            <t t-set="amount_discount" t-value="0"/>
                            <tr t-foreach="o.invoice_line_ids" t-as="l">
                                <td width="10%" align="center">
                                    <span t-esc="l.product_id.default_code"/>
                                </td>
                                <td width="25%" align="center">
                                    <span t-esc="l.product_id.name"/>
                                </td>
                                <td width="10%" align="center">
                                    <span t-esc="l.product_uom_id.name"/>
                                </td>
                                <td width="10%" align="center">
                                    <span t-esc="l.quantity"/>
                                </td>
                                <td width="10%" align="center">
                                    <span t-esc="l.price_unit"/>
                                </td>
                                <td width="10%" align="center">
                                    <span t-esc="'{0:,.2f}'.format((l.quantity*l.price_unit*(l.discount/100)))"/>
                                    <t t-set="amount_discount"
                                       t-value="amount_discount+(l.quantity*l.price_unit*(l.discount/100))"/>
                                </td>
                                <td width="12%" align="center">
                                    <span t-esc="'{0:,.2f}'.format(l.tax_value)"/>
                                </td>
                                <td width="15%" align="center">
                                    <span t-esc="'{0:,.2f}'.format(l.price_subtotal)"/>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <br/>
                    <br/>
                    <table class="table table-bordered" border="1" dir="rtl" width="100%">
                        <tr>
                            <td width="25%">
                                <p align="right">
                                    <strong>الاجمالي بدون خصم :</strong>
                                </p>
                            </td>
                            <td width="60%">
                                <p align="center">
                                    <span t-esc="o.convertNumber_ar(int(o.total_price_without_disc)) "/>
                                    (ريال)
                                    <t t-if="float(str(o.total_price_without_disc-int(o.total_price_without_disc)).split('.')[-1]) != 0">
                                        و
                                        <span t-esc="o.convertNumber_ar_split(float(str(o.total_price_without_disc-int(o.total_price_without_disc)).split('.')[1])) "/>
                                        (هللة فقط لاغير)
                                    </t>
                                </p>
                            </td>
                            <td width="15%">
                                <span t-esc="'{0:,.2f}'.format(o.total_price_without_disc)"/>
                            </td>
                        </tr>
                        <tr>
                            <td width="25%" valign="top">
                                <p align="right">
                                    <strong>الخصم :</strong>
                                </p>
                            </td>
                            <td width="60%">
                                <p align="center">
                                    <span t-esc="o.convertNumber_ar(int(amount_discount)) "/>
                                    (ريال)
                                    <t t-if="float(str(amount_discount-int(amount_discount)).split('.')[-1]) != 0">
                                        و
                                        <span t-esc="o.convertNumber_ar_split(float(str(amount_discount-int(amount_discount)).split('.')[1])) "/>
                                        (هللة فقط لاغير)
                                    </t>
                                </p>
                            </td>
                            <td width="15%" height="5">
                                <t t-esc="'{0:,.2f}'.format(amount_discount)"/>
                            </td>

                        </tr>
                        <tr>
                            <td width="25%" valign="top">
                                <p align="right">
                                    <strong>الاجمالي بعد الخصم :</strong>
                                </p>
                            </td>
                            <td width="60%">
                                <p align="center">
                                    <span t-esc="o.convertNumber_ar(int(o.amount_untaxed)) "/>
                                    (ريال)
                                    <t t-if="float(str(o.amount_untaxed-int(o.amount_untaxed)).split('.')[-1]) != 0">
                                        و
                                        <span t-esc="o.convertNumber_ar_split(float(str(o.amount_untaxed-int(o.amount_untaxed)).split('.')[1])) "/>
                                        (هللة فقط لاغير)
                                    </t>
                                </p>
                            </td>
                            <td width="15%">
                                <span t-esc="'{0:,.2f}'.format(o.amount_untaxed)"/>
                            </td>

                        </tr>
                        <tr>
                            <td width="25%">
                                <p align="right">
                                    <strong>الضريبة :</strong>
                                </p>
                            </td>
                            <td width="60%">
                                <p align="center">
                                    <span t-esc="o.convertNumber_ar(int(o.amount_tax)) "/>
                                    (ريال)
                                    <t t-if="float(str(o.amount_tax-int(o.amount_tax)).split('.')[-1]) != 0">
                                        و
                                        <span t-esc="o.convertNumber_ar_split(float(str(o.amount_tax-int(o.amount_tax)).split('.')[1])) "/>
                                        (هللة فقط لاغير)
                                    </t>
                                </p>
                            </td>
                            <td width="15%">
                                <span t-esc="'{0:,.2f}'.format(o.amount_tax)"/>
                            </td>

                        </tr>
                        <tr>
                            <td width="25%">
                                <p align="right">
                                    <strong>الاجمالي بعد الضريبة :</strong>
                                </p>
                            </td>
                            <td width="60%">
                                <p align="center">
                                    <span t-esc="o.convertNumber_ar(int(o.amount_total)) "/>
                                    (ريال)
                                    <t t-if="float(str(o.amount_total-int(o.amount_total)).split('.')[-1]) != 0">
                                        و
                                        <span t-esc="o.convertNumber_ar_split(float(str(o.amount_total-int(o.amount_total)).split('.')[1])) "/>
                                        (هللة فقط لاغير)
                                    </t>
                                </p>
                            </td>
                            <td width="15%">
                                <span t-esc="'{0:,.2f}'.format(o.amount_total)"/>
                            </td>
                        </tr>

                        <!--<tr>-->
                        <!--<td width="25%">-->
                        <!--<p align="right">-->
                        <!--<strong>صافي قيمة الفاتورة :</strong>-->
                        <!--</p>-->
                        <!--</td>-->
                        <!--<td width="60%">-->
                        <!--<p align="center">-->
                        <!--<span t-esc="o.convertNumber_ar(int(o.amount_total)) "/>-->
                        <!--(ريال)-->
                        <!--<t t-if="float(str(int(o.amount_total)).split('.')[-1]) != 0">-->
                        <!--و-->
                        <!--<span t-esc="o.convertNumber_ar_split(float(str(o.amount_total-int(o.amount_total)).split('.')[1])) "/>-->
                        <!--(هللة فقط لاغير)-->
                        <!--</t>-->
                        <!--</p>-->
                        <!--</td>-->
                        <!--<td width="15%">-->
                        <!--<span t-esc="'{0:,.2f}'.format(o.amount_total)"/>-->
                        <!--</td>-->
                        <!--</tr>-->
                    </table>
                    <p dir="rtl" style="text-align:right">
                        <span>تم إستلام الخدمات أو الأصناف الموضحة بعالية سليمة تماماً ... و تعمل بكفاءة و لا توجد
                            ملاحظات
                        </span>
                    </p>
                    <br/>
                    <!--<p dir="rtl">-->
                    <!--<strong dir="rtl">طريقة الســـــداد :</strong>-->
                    <!--<span>تحويل على حساب المؤسسة / </span>-->
                    <!--</p>-->
                    <br/>
                    <table style="height: 55px;" width="830">
                        <tbody>
                            <tr>
                                <!-- <td style="width: 96.5px; text-align: left;">
                                    <strong>المدير العام</strong>
                                </td> -->
                                <td style="width: 266px; text-align: center;">
                                    <strong>اعتماد</strong>
                                </td>
                                <!-- <td style="width: 298.5px; text-align: center;">
                                    <strong>اعتماد</strong>
                                </td> -->
                                <td style="width: 100px; text-align: right;">
                                    <strong>اعداد</strong>
                                </td>
                            </tr>
                            <tr>
                                <!-- <td style="width: 262px; text-align: left;">
                                    .............................
                                </td> -->
                                <td style="width: 166.5px; text-align: center;">
                                    ............................
                                </td>
                                <!-- <td style="width: 166px; text-align: center;">
                                    <span t-field="o.validate_user_id.name"/>
                                </td> -->
                                <td style="width: 166.5px; text-align: right;">
                                    <span t-field="o.create_uid.name"/>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </t>
            </div>
        </t>
    </template>
    <template id="customer_einvoice_report_ar">
        <t t-call="web.html_container">
            <t t-foreach="docs" t-as="doc">
                <t t-call="so_invoice_report.customer_einvoice_report_template_ar"/>
            </t>
        </t>
    </template>

    <report id="report_customer_invoice_report_ar"
            model="account.move"
            string="الفاتورة الإليكترونية"
            report_type="qweb-pdf"
            name="so_invoice_report.customer_einvoice_report_ar"
            file="so_invoice_report.customer_einvoice_report_ar"
            attachment_use="True"
    />
</odoo>